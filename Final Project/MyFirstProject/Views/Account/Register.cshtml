@model MyFirstProject.ViewModels.RegisterViewModel

@{
    ViewData["Title"] = "Register";
}

<h2>Register</h2>

<form asp-action="Register" method="post" enctype="multipart/form-data">
    @Html.AntiForgeryToken()

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="Username" class="form-label"></label>
            <input asp-for="Username" class="form-control" />
            <span asp-validation-for="Username" class="text-danger"></span>
        </div>

        <div class="col-md-6 mb-3">
            <label asp-for="Email" class="form-label"></label>
            <input asp-for="Email" class="form-control" />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="Password" class="form-label"></label>
            <input asp-for="Password" class="form-control" type="password" />
            <span asp-validation-for="Password" class="text-danger"></span>
        </div>

        <div class="col-md-6 mb-3">
            <label asp-for="ConfirmPassword" class="form-label"></label>
            <input asp-for="ConfirmPassword" class="form-control" type="password" />
            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
        </div>
    </div>

    <div class="mb-3">
        <label asp-for="Role" class="form-label">Select Role</label>
        <select asp-for="Role" class="form-select">
            <option value="">-- Select Role --</option>
            @foreach (var role in ViewBag.Roles)
            {
                <option value="@role.Value">@role.Text</option>
            }
        </select>
        <span asp-validation-for="Role" class="text-danger"></span>
    </div>

    <!-- Student Fields -->
    <div id="studentFields" class="border p-3 mb-3" style="display:none;">
        <h5>Student Info</h5>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label asp-for="Grade" class="form-label"></label>
                <input asp-for="Grade" class="form-control" type="number" min="1" max="12" />
                <span asp-validation-for="Grade" class="text-danger"></span>
            </div>

            <div class="col-md-4 mb-3">
                <label asp-for="DeptId" class="form-label">Department</label>
                <select asp-for="DeptId" class="form-select" asp-items="ViewBag.Departments">
                    <option value="">-- Select Department --</option>
                </select>
                <span asp-validation-for="DeptId" class="text-danger"></span>
            </div>

            <div class="col-md-4 mb-3">
                <label asp-for="Address" class="form-label"></label>
                <input asp-for="Address" class="form-control" />
                <span asp-validation-for="Address" class="text-danger"></span>
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">Upload Image</label>
            <input asp-for="ImageFile" type="file" class="form-control" />
            <span asp-validation-for="ImageFile" class="text-danger"></span>
        </div>
    </div>

    <!-- Instructor Fields -->
    <div id="instructorFields" class="border p-3 mb-3" style="display:none;">
        <h5>Instructor Info</h5>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label asp-for="Salary" class="form-label"></label>
                <input asp-for="Salary" class="form-control" type="number" min="0" max="100000" />
                <span asp-validation-for="Salary" class="text-danger"></span>
            </div>

            <div class="col-md-4 mb-3">
                <label asp-for="DeptId" class="form-label">Department</label>
                <select asp-for="DeptId" class="form-select" asp-items="ViewBag.Departments">
                    <option value="">-- Select Department --</option>
                </select>
                <span asp-validation-for="DeptId" class="text-danger"></span>
            </div>

            <div class="col-md-4 mb-3">
                <label asp-for="CrsId" class="form-label">Course</label>
                <select asp-for="CrsId" class="form-select" asp-items="ViewBag.Courses">
                    <option value="">-- Select Course --</option>
                </select>
                <span asp-validation-for="CrsId" class="text-danger"></span>
            </div>

            <div class="col-md-6 mb-3">
                <label asp-for="Address" class="form-label"></label>
                <input asp-for="Address" class="form-control" />
                <span asp-validation-for="Address" class="text-danger"></span>
            </div>

            <div class="col-md-6 mb-3">
                <label class="form-label">Upload Image</label>
                <input asp-for="ImageFile" type="file" class="form-control" />
                <span asp-validation-for="ImageFile" class="text-danger"></span>
            </div>
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Register</button>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        const roleSelect = document.getElementById('Role');
        const studentFields = document.getElementById('studentFields');
        const instructorFields = document.getElementById('instructorFields');

        function toggleFields() {
            if (roleSelect.value === 'Student') {
                studentFields.style.display = 'block';
                instructorFields.style.display = 'none';
            } else if (roleSelect.value === 'Instructor') {
                studentFields.style.display = 'none';
                instructorFields.style.display = 'block';
            } else {
                studentFields.style.display = 'none';
                instructorFields.style.display = 'none';
            }
        }

        roleSelect.addEventListener('change', toggleFields);
        toggleFields(); // initialize on page load
    </script>
}
